<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>snake game deluxe</title>
  <!-- –≤–Ω–µ—à–Ω–∏–π css (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª) -->
  <link rel="stylesheet" href="./style.css">

  <!-- –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ -->
  <style>
    body {
      margin:0;
      font-family:'segoe ui', sans-serif;
      transition:background 0.5s, color 0.5s;
      display:flex;
      flex-direction:row;
      min-height:100vh;
    }
    body.dark { background:linear-gradient(135deg,#1e3c72,#2a5298); color:#fff; }
    body.light { background:#f0f0f0; color:#222; }

    #main { flex:3; text-align:center; padding-bottom:60px; }
    #sidebar {
      flex:1;
      background:rgba(255,255,255,0.1);
      padding:20px;
      margin:20px;
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.3);
      font-size:0.95em;
      height:fit-content;
    }
    body.light #sidebar { background:rgba(0,0,0,0.05); box-shadow:0 0 10px rgba(0,0,0,0.1); }

    h1 { margin-top:20px; font-size:2.4em; text-shadow:2px 2px 5px rgba(0,0,0,0.5); }
    #scoreBoard { font-size:1.5em; margin:10px; font-weight:bold; }

    #game {
      background:#111;
      border:5px solid #fff;
      border-radius:10px;
      display:block;
      margin:20px auto;
      box-shadow:0 0 20px rgba(0,0,0,0.7);
    }
    body.light #game { background:#fff; border:5px solid #222; box-shadow:0 0 10px rgba(0,0,0,0.2); }

    #login, #leaderboard, #skins, #settings {
      background:rgba(255,255,255,0.1);
      padding:15px;
      margin:15px auto;
      width:70%;
      border-radius:10px;
      box-shadow:0 0 10px rgba(0,0,0,0.3);
    }
    body.light #login, body.light #leaderboard, body.light #skins, body.light #settings {
      background:rgba(0,0,0,0.05);
      box-shadow:0 0 10px rgba(0,0,0,0.1);
    }

    input, select, button {
      padding:10px 15px;
      margin:5px;
      border:none;
      border-radius:5px;
      font-size:1em;
    }
    input { width:200px; }
    button { background:#ff9800; color:#fff; cursor:pointer; transition:0.25s; }
    button:hover { background:#e68900; transform:scale(1.05); }
    #themeToggle { background:#2196f3; }
    #themeToggle:hover { background:#1976d2; }

    select { background:#333; color:#fff; }
    body.light select { background:#ddd; color:#222; }

    #leaderboard ol { list-style:none; padding:0; margin:0; }
    #leaderboard li {
      background:rgba(0,0,0,0.3);
      margin:5px;
      padding:8px;
      border-radius:5px;
      font-weight:bold;
    }
    body.light #leaderboard li { background:rgba(0,0,0,0.1); }

    .skin-btn { background:#4caf50; }
    .skin-btn:hover { background:#388e3c; }

    #contact {
      position:fixed;
      bottom:0;
      left:0;
      width:100%;
      background:rgba(0,0,0,0.7);
      color:#fff;
      padding:10px;
      text-align:center;
      font-size:0.9em;
      box-shadow:0 -2px 10px rgba(0,0,0,0.5);
      backdrop-filter:saturate(1.2);
    }
    body.light #contact {
      background:rgba(0,0,0,0.08);
      color:#222;
      box-shadow:0 -2px 10px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body class="dark">
  <div id="main">
    <h1>üêç snake game deluxe</h1>

    <!-- –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã -->
    <button id="themeToggle" onclick="toggleTheme()">üåó –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É</button>

    <!-- –≤—Ö–æ–¥ -->
    <div id="login">
      <input id="username" placeholder="–≤–≤–µ–¥–∏—Ç–µ –∏–º—è" />
      <button onclick="setUser()">–≤–æ–π—Ç–∏</button>
      <p id="currentUser">–∏–≥—Ä–æ–∫: –≥–æ—Å—Ç—å</p>
    </div>

    <!-- –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <div id="settings">
      <button onclick="startGame()">‚ñ∂ –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
      <select id="level" title="—Å–∫–æ—Ä–æ—Å—Ç—å —Ö–æ–¥–∞">
        <option value="100">–ª—ë–≥–∫–∏–π</option>
        <option value="80">—Å—Ä–µ–¥–Ω–∏–π</option>
        <option value="60">—Å–ª–æ–∂–Ω—ã–π</option>
      </select>
    </div>

    <!-- —Å–∫–∏–Ω—ã -->
    <div id="skins">
      <h3>üé® —Å–∫–∏–Ω—ã –∑–º–µ–π–∫–∏</h3>
      <button class="skin-btn" onclick="setSkin('lime')">–∫–ª–∞—Å—Å–∏–∫–∞</button>
      <button class="skin-btn" onclick="setSkin('yellow')">–∑–æ–ª–æ—Ç–∞—è (—Ä–µ–∫–æ—Ä–¥ ‚â•10)</button>
      <button class="skin-btn" onclick="setSkin('cyan')">–Ω–µ–æ–Ω (—Ä–µ–∫–æ—Ä–¥ ‚â•20)</button>
    </div>

    <!-- —Å—á—ë—Ç -->
    <div id="scoreBoard">–æ—á–∫–∏: 0</div>

    <!-- –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
    <canvas id="game" width="400" height="400"></canvas>

    <!-- –ª–∏–¥–µ—Ä–±–æ—Ä–¥ -->
    <div id="leaderboard">
      <h3>üèÜ –ª–∏–¥–µ—Ä–±–æ—Ä–¥</h3>
      <ol id="scores"></ol>
    </div>
  </div>

  <!-- –ø–∞–Ω–µ–ª—å –ø—Ä–∞–≤–∏–ª -->
  <div id="sidebar">
    <h2>üìú –ø—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h2>
    <p>1. —É–ø—Ä–∞–≤–ª—è–π –∑–º–µ–π–∫–æ–π —Å—Ç—Ä–µ–ª–∫–∞–º–∏ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ.</p>
    <p>2. —è–±–ª–æ–∫–∏:</p>
    <ul>
      <li>–∫—Ä–∞—Å–Ω–æ–µ üçé ‚Äî –æ–±—ã—á–Ω–æ–µ, +1 –æ—á–∫–æ.</li>
      <li>—Å–∏–Ω–µ–µ üîµ ‚Äî –∑–∞–º–µ–¥–ª—è–µ—Ç —Ö–æ–¥ –∏–≥—Ä—ã.</li>
      <li>–æ—Ä–∞–Ω–∂–µ–≤–æ–µ üü† ‚Äî —É—Å–∫–æ—Ä—è–µ—Ç —Ö–æ–¥ –∏–≥—Ä—ã.</li>
    </ul>
    <p>3. –≤—Ä–µ–∂–µ—à—å—Å—è –≤ —Å—Ç–µ–Ω—É –∏–ª–∏ –≤ —Å–µ–±—è ‚Äî game over.</p>
    <p>4. —Å–∫–∏–Ω—ã –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ —Ä–µ–∫–æ—Ä–¥–∞–º: ‚â•10 ‚Äî –∑–æ–ª–æ—Ç–æ, ‚â•20 ‚Äî –Ω–µ–æ–Ω.</p>
    <p>5. –≤—ã–±–∏—Ä–∞–π —Å–ª–æ–∂–Ω–æ—Å—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.</p>
  </div>

  <!-- –∫–æ–Ω—Ç–∞–∫—Ç—ã -->
  <div id="contact">
    ‚ö†Ô∏è –µ—Å–ª–∏ —á—Ç–æ‚Äë—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å ‚Äî —Å–≤—è–∑—å —Å –≥–ª–∞–≤–Ω—ã–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º —á–µ—Ä–µ–∑ telegram:
    <strong>@illuminatedwisdom</strong>
  </div>

  <!-- –æ—Å–Ω–æ–≤–Ω–æ–π js -->
  <script>
    // –∫–∞–Ω–≤–∞—Å –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    // –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
    const box = 20;
    const gridSize = canvas.width / box; // 20
    const SPEED_MIN = 40;
    const SPEED_MAX = 160;
    const SPEED_STEP = 20;

    // —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
    let snake = [];
    let direction = 'RIGHT';
    let food = null; // {x, y, type: 'normal'|'slow'|'fast'}
    let game = null;
    let score = 0;
    let currentSpeed = 100; // —Ç–µ–∫—É—â–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ setInterval
    let skin = 'lime';
    let currentUser = '–≥–æ—Å—Ç—å';
    let leaderboard = [];

    // —Ç–µ–º–∞
    function toggleTheme() {
      if (document.body.classList.contains('dark')) {
        document.body.classList.remove('dark');
        document.body.classList.add('light');
      } else {
        document.body.classList.remove('light');
        document.body.classList.add('dark');
      }
    }

    // –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    function setUser() {
      currentUser = document.getElementById('username').value || '–≥–æ—Å—Ç—å';
      document.getElementById('currentUser').innerText = '–∏–≥—Ä–æ–∫: ' + currentUser;
    }

    // —Å–∫–∏–Ω—ã —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–µ–∫–æ—Ä–¥–∞
    function getBestScore() {
      return leaderboard.length ? leaderboard[0].score : 0;
    }
    function setSkin(color) {
      if (color === 'yellow' && getBestScore() < 10) return alert('–æ—Ç–∫—Ä–æ–π –ø—Ä–∏ —Ä–µ–∫–æ—Ä–¥–µ ‚â•10!');
      if (color === 'cyan' && getBestScore() < 20) return alert('–æ—Ç–∫—Ä–æ–π –ø—Ä–∏ —Ä–µ–∫–æ—Ä–¥–µ ‚â•20!');
      skin = color;
    }

    // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
    function initGame() {
      snake = [{ x: 9 * box, y: 10 * box }];
      direction = 'RIGHT';
      score = 0;
      updateScore();
      currentSpeed = parseInt(document.getElementById('level').value, 10);
      placeFood();
      draw(); // –æ—Ç—Ä–∏—Å—É–µ–º —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —á—Ç–æ–±—ã "–∑–º–µ–π–∫–∞ –ø–æ—è–≤–∏–ª–∞—Å—å"
    }

    // —Å—Ç–∞—Ä—Ç —Ü–∏–∫–ª–∞
    function startGame() {
      clearInterval(game);
      initGame();
      game = setInterval(draw, currentSpeed);
    }

    // —Å–±—Ä–æ—Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
    function resetInterval() {
      clearInterval(game);
      game = setInterval(draw, currentSpeed);
    }

    // –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∞–≤–∏—à
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft' && direction !== 'RIGHT') direction = 'LEFT';
      if (e.key === 'ArrowUp' && direction !== 'DOWN') direction = 'UP';
      if (e.key === 'ArrowRight' && direction !== 'LEFT') direction = 'RIGHT';
      if (e.key === 'ArrowDown' && direction !== 'UP') direction = 'DOWN';
    });

    // —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –µ–¥—ã
    function placeFood() {
      let valid = false;
      let x, y;
      while (!valid) {
        x = Math.floor(Math.random() * gridSize) * box;
        y = Math.floor(Math.random() * gridSize) * box;
        valid = !snake.some(seg => seg.x === x && seg.y === y);
      }
      const r = Math.random();
      const type = r < 0.7 ? 'normal' : r < 0.85 ? 'slow' : 'fast'; // 70% –æ–±—ã—á–Ω–æ–µ, 15% –∑–∞–º–µ–¥–ª—è—é—â–µ–µ, 15% —É—Å–∫–æ—Ä—è—é—â–µ–µ
      food = { x, y, type };
    }

    // –≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª –æ—Ç—Ä–∏—Å–æ–≤–∫–∏/–ª–æ–≥–∏–∫–∏
    function draw() {
      // –æ—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // —Ä–∏—Å—É–µ–º –∑–º–µ–π–∫—É
      for (let i = 0; i < snake.length; i++) {
        ctx.fillStyle = i === 0 ? skin : 'white';
        ctx.fillRect(snake[i].x, snake[i].y, box, box);
      }

      // —Ä–∏—Å—É–µ–º –µ–¥—É –ø–æ —Ç–∏–ø—É
      if (food) {
        if (food.type === 'normal') ctx.fillStyle = 'red';
        else if (food.type === 'slow') ctx.fillStyle = 'blue';
        else ctx.fillStyle = 'orange';
        ctx.fillRect(food.x, food.y, box, box);
      }

      // —Ç–µ–∫—É—â–µ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –≥–æ–ª–æ–≤—ã
      let snakeX = snake[0].x;
      let snakeY = snake[0].y;

      // –¥–≤–∏–∂–µ–Ω–∏–µ
      if (direction === 'LEFT') snakeX -= box;
      if (direction === 'UP') snakeY -= box;
      if (direction === 'RIGHT') snakeX += box;
      if (direction === 'DOWN') snakeY += box;

      // –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –µ–¥—É
      if (food && snakeX === food.x && snakeY === food.y) {
        score++;
        updateScore();

        // –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü-—è–±–ª–æ–∫
        if (food.type === 'slow') {
          currentSpeed = Math.min(SPEED_MAX, currentSpeed + SPEED_STEP);
          resetInterval();
        } else if (food.type === 'fast') {
          currentSpeed = Math.max(SPEED_MIN, currentSpeed - SPEED_STEP);
          resetInterval();
        }

        placeFood(); // –Ω–æ–≤–∞—è –µ–¥–∞
        // –Ω–µ —É–¥–∞–ª—è–µ–º —Ö–≤–æ—Å—Ç ‚Äî –∑–º–µ–π–∫–∞ —Ä–∞—Å—Ç—ë—Ç
      } else {
        // –¥–≤–∏–≥–∞–µ–º—Å—è –±–µ–∑ –µ–¥—ã ‚Äî —É–¥–∞–ª—è–µ–º —Ö–≤–æ—Å—Ç
        snake.pop();
      }

      // –Ω–æ–≤–∞—è –≥–æ–ª–æ–≤–∞
      const newHead = { x: snakeX, y: snakeY };

      // —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è: —Å—Ç–µ–Ω—ã/—Å–∞–º —Å —Å–æ–±–æ–π
      const hitWall = snakeX < 0 || snakeY < 0 || snakeX >= canvas.width || snakeY >= canvas.height;
      const hitSelf = snake.some(seg => seg.x === newHead.x && seg.y === newHead.y);

      if (hitWall || hitSelf) {
        clearInterval(game);
        alert('game over! –æ—á–∫–∏: ' + score);
        saveScore(currentUser, score);
        updateLeaderboard();
        return; // –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ü–∏–∫–ª
      }

      // –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –≥–æ–ª–æ–≤—É
      snake.unshift(newHead);
    }

    // —Å—á—ë—Ç
    function updateScore() {
      document.getElementById('scoreBoard').innerText = '–æ—á–∫–∏: ' + score;
    }

    // –ª–∏–¥–µ—Ä–±–æ—Ä–¥
    function saveScore(user, score) {
      leaderboard.push({ user, score });
      leaderboard.sort((a, b) => b.score - a.score);
      leaderboard = leaderboard.slice(0, 5);
    }
    function updateLeaderboard() {
      const list = document.getElementById('scores');
      list.innerHTML = '';
      leaderboard.forEach(item => {
        const li = document.createElement('li');
        li.textContent = item.user + ' ‚Äî ' + item.score;
        list.appendChild(li);
      });
    }

    // –ø–µ—Ä–≤–∏—á–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞, —á—Ç–æ–±—ã –≤—Å—ë –≤–∏–¥–Ω–æ —Å—Ä–∞–∑—É
    initGame();
    updateLeaderboard();
  </script>
</body>
</html>
